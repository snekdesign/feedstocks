context:
  version: 8.0.1
  sha256: 05ee0b03119b45c0bdb4df654b96802e909e0a752f72e4fe3794f487229e5a41

package:
  name: ffmpeg
  version: ${{ version }}

source:
- url: https://ffmpeg.org/releases/ffmpeg-${{ version|trim('0')|trim('.') }}.tar.xz
  sha256: ${{ sha256 }}
  patches:
  - 0001-customize.patch

build:
  number: 0
  script:
    content:
    - bash -el "%RECIPE_DIR%\build.sh"
    env:
      MSYS2_PATH_TYPE: inherit
  skip:
  - not win
  - build_platform != target_platform
  - not (compiler('c') is startingwith('vs'))

requirements:
  build:
  - ${{ compiler('c') }}
  - m2-base
  - m2-diffutils
  - m2-make
  host:
  - ffnvcodec-headers
  - libiconv
  - nasm
  - pkg-config
  - sdl2 >=2.23.1

tests:
- script:
  - ffmpeg -version
  - ffplay -version
  - ffprobe -version

about:
  license: GPL-2.0-or-later
  license_family: GPL
  license_file: COPYING.GPLv2
  summary: Cross-platform solution to record, convert and stream audio and video.
