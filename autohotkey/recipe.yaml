context:
  version: 2.0.21
  sha256_src: 6bb4332a202d40efda86d1b466b817a4d109040831b3af5f54b3740a276e4905
  sha256_bin: 7386f45be928f0825ffbe78811187636d72efcbd264e2fd406e7e045d681a626

package:
  name: autohotkey
  version: ${{ version }}

source:
- url: https://codeload.github.com/AutoHotkey/AutoHotkey/tar.gz/v${{ version }}
  sha256: ${{ sha256_src }}
  patches:
  - 0001-conda-build.patch
- url: https://github.com/AutoHotkey/AutoHotkey/releases/download/v${{ version }}/AutoHotkey_${{ version }}.zip
  sha256: ${{ sha256_bin }}
  target_directory: bin

build:
  number: 0
  script:
  - md "%LIBRARY_PREFIX%\etc\inc"
  - msbuild AutoHotkeyx.vcxproj -p:Configuration=Release;Platform=x64
  - mklink /H "%LIBRARY_BIN%\AutoHotkey.exe" bin\AutoHotkey64.exe
  - mklink /H "%LIBRARY_PREFIX%\etc\AutoHotkey.chm" bin\AutoHotkey.chm
  - mklink /H "%LIBRARY_PREFIX%\etc\WindowSpy.ahk" bin\UX\WindowSpy.ahk
  - mklink /H "%LIBRARY_PREFIX%\etc\inc\spy.ico" bin\UX\inc\spy.ico
  skip:
  - not win
  - build_platform != target_platform
  - not (compiler('cxx') is startingwith('vs'))

requirements:
  build:
  - ${{ compiler('cxx') }}

about:
  license: GPL-2.0-only
  license_family: GPL
  license_file: license.txt
  summary: macro-creation and automation-oriented scripting utility for Windows
